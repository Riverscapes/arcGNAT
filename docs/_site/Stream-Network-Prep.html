<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>GNAT</title>

      <meta name="viewport" content="width=device-width">
      <link rel="stylesheet" href="/assets/css/app.css">
      <link rel="stylesheet" href="/assets/css/custom.css">
      <script src="https://use.fontawesome.com/586b1e1322.js"></script>

      <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/favicons/apple-icon-57x57.png">
      <link rel="apple-touch-icon" sizes="60x60" href="/assets/images/favicons/apple-icon-60x60.png">
      <link rel="apple-touch-icon" sizes="72x72" href="/assets/images/favicons/apple-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="76x76" href="/assets/images/favicons/apple-icon-76x76.png">
      <link rel="apple-touch-icon" sizes="114x114" href="/assets/images/favicons/apple-icon-114x114.png">
      <link rel="apple-touch-icon" sizes="120x120" href="/assets/images/favicons/apple-icon-120x120.png">
      <link rel="apple-touch-icon" sizes="144x144" href="/assets/images/favicons/apple-icon-144x144.png">
      <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/favicons/apple-icon-152x152.png">
      <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-icon-180x180.png">
      <link rel="icon" type="image/png" sizes="192x192"  href="/assets/images/favicons/android-icon-192x192.png">
      <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicons/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="96x96" href="/assets/images/favicons/favicon-96x96.png">
      <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicons/favicon-16x16.png">
      <link rel="manifest" href="/assets/images/favicons/manifest.json">
      <meta name="msapplication-TileColor" content="#ffffff">
      <meta name="msapplication-TileImage" content="/assets/images/favicons/ms-icon-144x144.png">
      <meta name="theme-color" content="#ffffff">

      <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
      <![endif]-->
  </head>

  <body>

  <header>
    <div id="topbarnav"></div>
    <div id="headcallout" class="text-center callout large">
      

      
      <h4 class="subheader show-for-medium"><a href="/">GNAT</a></h4>   
      <h1>Stream Network Preparation</h1>
            
      
    </div>
  </header>

  <div id="inner-wrapper">
    <div id="inner" class="row">
      <div id="main" class="large-8 columns large-push-4">
        <section><h2 id="step-1---stream-network-preparation">Step 1 - Stream Network Preparation</h2>

<p>One of the primary reasons a user may want to use GNAT will be to produce a stream network dataset that is segmented 
using the <strong>Segment Stream Network</strong> tool. In order for a segmentation process to be successful, that tool requires a 
stream network that is free from topological errors, with all subnetwork identified. For GNAT, we define a topologically 
clean network based on the following criteria:</p>

<ul>
  <li>No duplicate reaches</li>
  <li>Only one outflow per subnetwork</li>
  <li>All digitized directions flow downstream</li>
</ul>

<p>The first tool found in GNAT under <code class="highlighter-rouge">Analyze Network Attributes &gt; Step 1 - Stream Network Preperation</code> is the <strong>Find 
Subnetworks</strong> tool. This tools is intended to be run iteratively, ultimately producing a topologically-clean stream 
network that will serve as an input for the <strong>Generate Network Attributes</strong> tool. The <strong>Generate Network Attributes</strong> tool
will calculate and add network edge type attributes to the network, and will also generate a network node dataset. This 
attributed network will then be supplied to the <strong>Generate Strahler Stream Order</strong> tool, and the output for that tool can 
serve as input for the last step in the stream network preparation process - the <strong>Generate Stream Branches</strong> tool. The 
end goal of the workflow described here is a topologically clean, attributed shapefile that can serve as an input for the 
 <strong>Segment Stream Network</strong> tool. The following steps are a suggested workflow for producing such a network.</p>

<h3 id="suggested-workflow-for-step-1">Suggested Workflow for Step 1</h3>

<h5 id="identifying-subnetworks-and-fixing-topology-errors">Identifying subnetworks and fixing topology errors</h5>

<ol>
  <li>Create a workspace (folder or file geodatabase) that will store all interim data products.
    <ul>
      <li><strong><em>Please Note</em></strong>:  When creating or using a Riverscapes project, please ensure that all interim, working data 
  products are stored <strong>separately</strong> from where Riverscapes project files are stored. Do NOT use datasets stored in 
  Riverscape project folders for active processing in the tools.</li>
    </ul>
  </li>
  <li>If the stream network is a USGS NHD dataset, which includes an attribute field called <code class="highlighter-rouge">FType</code>, we recommend removing 
all features where <code class="highlighter-rouge">FType = 336'</code>. These features represent canals within the stream network, and will likely cause 
problems with network topology.</li>
  <li>Add the stream network (which must be in a shapefile format) as an input to the <strong>Find Subnetworks</strong> tool. Ideally, 
this should be an NHD flowline dataset, and include a stream name attribute field such as <code class="highlighter-rouge">GNIS_Name</code>.</li>
  <li>Do <em>NOT</em> choose the <code class="highlighter-rouge">Find topology errors</code> option.</li>
  <li>Run the <strong>Find Subnetworks</strong> tool, which produces:
    <ul>
      <li>a new shapefile, with the following attribute fields added:</li>
    </ul>
    <ul>
      <li><code class="highlighter-rouge">_FID_</code> : unique ID code for each line feature</li>
      <li><code class="highlighter-rouge">_netid_</code> : unique ID code for each subnetwork</li>
    </ul>
  </li>
  <li>The user should now symbolize the output shapefile in ArcMap using the <code class="highlighter-rouge">_netid_</code> attribute field, by assigning a unique 
random color for each <code class="highlighter-rouge">_netid_</code> value. This will highlight all of the disconnected subnetworks found by the tool. The user 
must now decide which subnetworks are disconnected erroneously, and which subnetworks should stay disconnected (or be 
discarded entirely). Erroneously disconnected networks should be connected manually using ArcMap editing tools.</li>
</ol>

<p><img src="/images/find_subnetworks_output.PNG" alt="find_subnetworks_output.PNG" /></p>

<ol>
  <li>Rerun the <strong>Find Subnetworks</strong> tool again with the edited shapefile as input, but this time select the 
<code class="highlighter-rouge">Find topology errors</code> option.</li>
  <li>If the <code class="highlighter-rouge">Find topology errors</code> option is selected, the resulting output shapefile will include three additional 
attribute fields:
    <ul>
      <li><code class="highlighter-rouge">_err_dupe_</code> : boolean value indicates if the line feature is a duplicate of another feature (based on calculate 
  length).</li>
      <li><code class="highlighter-rouge">_err_conf_</code> : boolean value indicates if the line feature has an upstream flow direction.</li>
      <li><code class="highlighter-rouge">_err_out_</code> : boolean indicates either a problem with flow direction (multiple reachs flowing to the same node) or a
subnetwork where the number of outflow features &gt; 0.</li>
    </ul>
  </li>
  <li>Add the output to ArcMap, but this time symbolize using the error fields. By highlighting the location
of the errors, the user can then use ArcMap editing tools to manually correct these features.</li>
  <li>At this point, the user can choose to continue running the <strong>Find Subnetworks</strong> tool until no errors are found.</li>
</ol>

<p><strong><em>Please Note</em></strong>: the errors found by the <strong>Find Subnetworks</strong> tool should only be viewed as <em>potential errors</em>. Whether
or not a stream feature actually has a topological error, and how it should be corrected, is up to the user and should be
determined on a case-by-case basis.</p>

<h5 id="generate-network-attributes-stream-order-and-stream-branch-ids">Generate network attributes, stream order, and stream branch IDs.</h5>

<ol>
  <li>
    <p>Using a shapefile representing a topologically clean network with subnetworks identified, run the <strong>Generate Network
Attributes</strong> tool. This tool iterates through each subnetwork within the shapefile, and labels each feature with an 
‘edge type’. Edge types are based on the topological context of each feature in relation to the rest of the features in
subnetwork.</p>

    <p>Edge types include:</p>
    <ul>
      <li>headwaters</li>
      <li>connectors</li>
      <li>mainflow</li>
      <li>braids</li>
      <li>outflow</li>
    </ul>

    <p>In addition, the <strong>Generate Network Attributes</strong> tool also generates a new point shapefile, which represents network 
nodes.</p>
  </li>
</ol>

<p><img src="/images/network_attrb_edges.PNG" alt="network_attrb_edges.PNG" /></p>

<ol>
  <li>After processing is finished, the edge type classification of output shapefile should be reviewed in ArcMap, with 
symbolization based on the <code class="highlighter-rouge">_edgetype_</code> attribute field.</li>
  <li>The output from the <strong>Generate Network Attributes</strong> tool should then serve as the input for the 
<strong>Generate Strahler Stream Order</strong> tool. Stream order will be calculated separately for each subnetwork found within the 
network shapefile.</li>
  <li>Symbolize the output shapefile using the <code class="highlighter-rouge">_strmordr_</code> attribute field, and review the strahler stream order values.
Each subnetwork within the shapefile will have it’s own separate stream order classification.</li>
  <li>Finally, run the <strong>Generate Stream Branches</strong>, and then symbolize and review the stream branch ID values, using the 
<code class="highlighter-rouge">BranchID</code> attribute field.</li>
</ol>

<p>At this point, the network shapefile produced by the <strong>Generate Stream Branches</strong> tool can be used as input for the 
<strong>Segment Stream Network</strong> tool.</p>
</section>
      </div>
      <div id="sidebar" class="large-4 columns large-pull-8">
          
	
	<div class="title-bar">
		<div class="title-bar-title"><i class="fa fa-file-text"></i> Page Contents</div>		
	</div>
	<div id="toc"></div>
	


<div class="title-bar">
	<div class="title-bar-title"><i class="fa fa-sitemap"></i> Site Contents
		<div id="menuCtls" class="button-group tiny show-for-medium">
				<span id="expand" class="button primary fa fa-plus has-tip top" data-tooltip title="Expand all items" aria-haspopup="true" data-disable-hover="false" ></span>
				<span id="contract" class="button primary fa fa-minus has-tip top" data-tooltip title="Contract all items" aria-haspopup="true" data-disable-hover="false" ></span>
			</div>	
	</div>
</div>
<div id="sidenav">
			<ul id='HTMLOnlyNav'>							<li><a href='/About-GNAT-Projects.html'>Riverscapes Projects</a></li>							<li><a href='/Build-Network-Topology-Table.html'>Build Network Topology Table</a></li>							<li><a href='/Calculate-Gradient.html'>Calculate Gradient</a></li>							<li><a href='/Calculate-Threadedness.html'>Calculate Threadedness</a></li>							<li><a href='/Centerline-Tool.html'>Centerline Tool</a></li>							<li><a href='/CombineAttributes.html'>Combine Attributes</a></li>							<li><a href='/Divide-Polygon-by-Segments.html'>Divide Polygons by Segments</a></li>							<li><a href='/Find-Braids-in-Stream-Network.html'>Find Braids in Stream Network</a></li>							<li><a href='/Find-Subnetworks.html'>Find Subnetworks</a></li>							<li><a href='/Generate-Network-Attributes.html'>Generate Network Attributes</a></li>							<li><a href='/Generate-Stream-Branches.html'>Generate Stream Branches</a></li>							<li><a href='/Generate-Stream-Order.html'>Generate Stream Order</a></li>							<li><a href='/Project_CommitRealization.html'>Commit Realization</a></li>							<li><a href='/Project_LoadNetwork.html'>Load Input Datsets</a></li>							<li><a href='/Project_NewGNATProject.html'>Create a New GNAT Project</a></li>							<li><a href='/Segment-Stream-Network.html'>Segment Stream Network</a></li>							<li><a href='/Sinuosity-by-Segment.html'>Sinousity by Segment</a></li>							<li><a href='/Stream-Network-Prep.html'>Stream Network Preparation</a></li>							<li><a href='/Stream-Sinuosity-and-Planform.html'>Stream Sinousity and Planform</a></li>							<li><a href='/Transfer-Line-Attributes.html'>Transfer Line Attributes</a></li>							<li><a href='/'>Home</a></li>		</ul>	
</div>

        </div>
    </div>
  </div>


    <footer id="footer" class="row">
<div id="rightslogo">
    <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">
        <img src="/assets/images/cc-watermarks-riverscapes_orig.png" alt="Picture">
    </a>
</div>
</footer>
    <script type="text/javascript">var NAVTitle = "GNAT";var NAVHome = "";var NAVPages = [{url: "/About-GNAT-Projects.html",absurl: "/About-GNAT-Projects.html",slug: "About-GNAT-Projects.html",title: "Riverscapes Projects",weight: ""},{url: "/Build-Network-Topology-Table.html",absurl: "/Build-Network-Topology-Table.html",slug: "Build-Network-Topology-Table.html",title: "Build Network Topology Table",weight: ""},{url: "/Calculate-Gradient.html",absurl: "/Calculate-Gradient.html",slug: "Calculate-Gradient.html",title: "Calculate Gradient",weight: ""},{url: "/Calculate-Threadedness.html",absurl: "/Calculate-Threadedness.html",slug: "Calculate-Threadedness.html",title: "Calculate Threadedness",weight: ""},{url: "/Centerline-Tool.html",absurl: "/Centerline-Tool.html",slug: "Centerline-Tool.html",title: "Centerline Tool",weight: ""},{url: "/CombineAttributes.html",absurl: "/CombineAttributes.html",slug: "CombineAttributes.html",title: "Combine Attributes",weight: ""},{url: "/Divide-Polygon-by-Segments.html",absurl: "/Divide-Polygon-by-Segments.html",slug: "Divide-Polygon-by-Segments.html",title: "Divide Polygons by Segments",weight: ""},{url: "/Find-Braids-in-Stream-Network.html",absurl: "/Find-Braids-in-Stream-Network.html",slug: "Find-Braids-in-Stream-Network.html",title: "Find Braids in Stream Network",weight: ""},{url: "/Find-Subnetworks.html",absurl: "/Find-Subnetworks.html",slug: "Find-Subnetworks.html",title: "Find Subnetworks",weight: ""},{url: "/Generate-Network-Attributes.html",absurl: "/Generate-Network-Attributes.html",slug: "Generate-Network-Attributes.html",title: "Generate Network Attributes",weight: ""},{url: "/Generate-Stream-Branches.html",absurl: "/Generate-Stream-Branches.html",slug: "Generate-Stream-Branches.html",title: "Generate Stream Branches",weight: ""},{url: "/Generate-Stream-Order.html",absurl: "/Generate-Stream-Order.html",slug: "Generate-Stream-Order.html",title: "Generate Stream Order",weight: ""},{url: "/Project_CommitRealization.html",absurl: "/Project_CommitRealization.html",slug: "Project_CommitRealization.html",title: "Commit Realization",weight: ""},{url: "/Project_LoadNetwork.html",absurl: "/Project_LoadNetwork.html",slug: "Project_LoadNetwork.html",title: "Load Input Datsets",weight: ""},{url: "/Project_NewGNATProject.html",absurl: "/Project_NewGNATProject.html",slug: "Project_NewGNATProject.html",title: "Create a New GNAT Project",weight: ""},{url: "/Segment-Stream-Network.html",absurl: "/Segment-Stream-Network.html",slug: "Segment-Stream-Network.html",title: "Segment Stream Network",weight: ""},{url: "/Sinuosity-by-Segment.html",absurl: "/Sinuosity-by-Segment.html",slug: "Sinuosity-by-Segment.html",title: "Sinousity by Segment",weight: ""},{url: "/Stream-Network-Prep.html",absurl: "/Stream-Network-Prep.html",slug: "Stream-Network-Prep.html",title: "Stream Network Preparation",weight: ""},{url: "/Stream-Sinuosity-and-Planform.html",absurl: "/Stream-Sinuosity-and-Planform.html",slug: "Stream-Sinuosity-and-Planform.html",title: "Stream Sinousity and Planform",weight: ""},{url: "/Transfer-Line-Attributes.html",absurl: "/Transfer-Line-Attributes.html",slug: "Transfer-Line-Attributes.html",title: "Transfer Line Attributes",weight: ""},{url: "/",absurl: "/",slug: "",title: "Home",weight: ""},];var SiteSettings = {"autoPageContents":{"active":true,"onHome":false},"sideMenu":{"homeItem":true,"startExpanded":false},"topmenu":[{"title":"Riverscapes","childern":[{"title":"Model Home","url":"index"},{"title":"Riverscapes Home","url":"http://riverscapes.xyz"},{"title":"About Riverscapes","url":"http://riverscapes.xyz/about.html"},{"title":"Who We Are","url":"http://riverscapes.xyz/who-we-are.html"},{"title":"News","url":"http://riverscapes.xyz/news.html"}]},{"title":"RC Tools","url":"http://riverscapes.xyz/rc-tools.html"},{"title":"RC Science","url":"http://riverscapes.xyz/rc-science.html"},{"title":"RC Data","url":"http://riverscapes.xyz/rc-data.html"},{"title":"RC Help","url":"http://riverscapes.xyz/rc-help.html"}]};</script>

    <script src="/assets/js/dist.js"></script>

  </body>

</html>
