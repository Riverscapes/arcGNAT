The **Find Network Features** tool finds topological features and errors within a stream
network polyline feature class. The stream network  is assumed to be a single-part non-braided topological network. Currently the  **Find Network Features** tool can find these topological features (some of which could be considered errors):

* Braids
* Duplicate reaches
* Overlapping reaches 
* Crossed reaches
* Disconnected reaches
* Upstream flow direction
* Other potential errors

The **Find Network Feature** tool relies on two inputs: a stream network polyline
 feature class, and the network topology table generated by the **Build Network 
 Topology Table** from the stream network feature class, which should be named
 _StreamNetwork_.

The resulting **Find Network Features** table, _NetworkFeatures_, stores records for 
each stream reach,and each record includes the reach unique ID and a numeric code 
for each feature or error type. This table can then be joined back to the input stream network polyline feature class and symbolized in ArcMap to highlight stream reaches with topological features and errors, which the user can then manually fix using ArcGIS editing tools.

**Illustrated examples**

| Feature Type            | Example                                                                      |
| ----------------------- | -----------------------------------------------------------------------------|
| Braids                  | ![error_braid]({{site.baseurl}}/images/findNetworkError_braid.png)            |
| Duplicate Reaches       | ![error_duplicate]({{site.baseurl}}/images/findNetworkError_dup.png)          |
| Overlapping Reaches     | ![error_overlap]({{site.baseurl}}/images/findNetworkError_overlap.png)        |  
| Crossed Reaches         | ![error_crossed]({{site.baseurl}}/images/findNetworkError_crossed.png)        |
| Disconnected Reaches    | ![error_disconnected]({{site.baseurl}}/images/findNetworkError_disconnect.png)|
| Upstream flow direction | ![error_flowdirection]({{site.baseurl}}/images/findNetworkError_flow.png)     |

__________________________________________________________________________________________________________
## Usage

### Geoprocessing Environment

* We recommend running the tool using 64-bit python geoprocessing.
* Disable Z and M values in the input stream network feature class Shape field.

### Input Parameters

![find_errors_form]({{site.baseurl}}/images/find_errors_form.PNG)

**Processed Input Stream Network**

Stream network polyline feature class that has been output by the **Build Network Topology Table** tool. Most likely the feature class name will include a suffix using the following format: "_runXX" (i.e. run01, run02, etc), however, this is not required.

**Stream Network Table**

Stream network topology table, in either a DBF file or geodatabase table format. This table is output from the **Build Network Topology Table**. The table should be named _StreamNetwork_.

**Downstream Reach ID**

Object ID of the downstream reach (i.e. the outflow) in the stream network polyline feature class. This value is also the first record in the output network topology table _StreamNetwork_.

### Outputs

**NetworkFeatures**

The resulting network topology table, including feature codes stored in a new attribute field: `feature_code`. The table will be saved to the same workspace where the input stream network dataset is stored.

_______________________________________________________________
## Technical Background

### Calculation Method

Methods for finding each feature type differ, and can rely on either the stream
network polyline feature class or the network topology table. 

* `feature_code = 2` - Braids: calls the **Find Braids in Stream Network** tool.
* `feature_code = 3` - Duplicate reaches: stream reaches with identical lengths.
* `feature_code = 4` - Overlapping reaches: each stream reach is compared to neighboring upstream reach. They are considered overlapping if they share nodes other than their beginning/ending nodes.
* `feature_code = 5` - Crossed reaches: each stream reach is compared to neighboring upstream reach. They are considered crossed if they cross, but do not share beginning/ending nodes.
* `feature_code = 6` - Disconnected reaches: reaches that are present in the stream network polyline feature class, without associated records in the network topology table are considered disconnected.
* `feature_code = 7` - Upstream flow direction: reaches with identical FROM nodes indicate an error in flow direction (see Troubleshooting and Potential Issues section below for known limitations).
* `feature_code = 8` - Other potential errors: based on reach records in the network topology table where UpstreamID = -11111.

### Post-processing

A typical next step after generating the _NetworkFeatures_ table would be to add the table to an ArcMap session, along with the input stream network feature class.  After joining the table to the stream network (using the `ReachID` field), the user can visualize the location of topological errors by symbolizing by `feature_code`. The user can then utilize ArcMap editing tools to manual edit these features if they are actual topological errors.

This process can then be repeated by running the repaired stream network feature class through the **Find Network Features** tool to find any missed errors. 

### Troubleshooting and Potential Issues

Because the method for finding flow direction errors is performed in a pairwise fashion(i.e. the reach and the neighboring upstream reach), a reach is considered to have an incorrect flow direction only in relation to the neighboring reach, due to both reaches having the same FROM node values. In the case of a stream branch where all of the reaches comprising that branch have an incorrect flow direction, the tool will only tag one reach with the flow direction feature code.

Therefore, the user should use caution when reviewing reaches where `feature_code = 2`. Nearby stream reaches should also be examined to ensure proper flow direction.